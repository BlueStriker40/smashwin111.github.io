<html>

  <head>

    <!-- Load the Firebase library before loading the body. -->
    <script src="https://www.gstatic.com/firebasejs/3.1.0/firebase.js"></script>

    <!-- Load the jQuery library, which we'll use to manipulate HTML elements with Javascript. -->
    <script src="https://code.jquery.com/jquery-2.2.0.min.js"></script>

    <!-- Load Bootstrap stylesheet, which will is CSS that makes everything prettier and also responsive (aka will work on all devices of all sizes). -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
  </head>

  <body>

    <div class="container">
	    
      <h3>Submit a Comment</h3>

      <form id="commentForm">
		  
        <div class="form-group">
          <label for="yourName">Name</label>
          <input class="form-control" id="yourName" placeholder="Your name" maxlength="20">
        </div>

        <div class="form-group">
          <label for="yourComment">Comment</label>
          <input class="form-control" id="yourComment" placeholder="Your comment" maxlength="100">
        </div>

        <div class="form-group">
          <label for="yourLink">Link (optional)</label>
          <input type="url" class="form-control" id="yourLink" placeholder="Your link (optional)" maxlength="100">
        </div>

        <!-- When you click this button, trigger the submit event on this form. -->
        <button type="submit" class="btn btn-default" onclick="alert('Thank you for submitting')">Submit</button>
		
      </form>
	  
	  <br> <br> <br>
	  
      <h3>10 most recent comments</h3>

      <table class="table table-striped">
		  
        <thead>
          <tr>
            <th>Name</th>
            <th>Comment</th>
            <th>Link (optional)</th>
          </tr>
        </thead>
		
        <tbody>
          <tr>
            <!-- This is empty for now, but it will be filled out by an event handler in application.js with the most recent recommendation data from Firebase. -->
            <td id="title"></td>
            <td id="remark"></td>
            <td><a id="link" target="_blank"></a></td>
          </tr>
        </tbody>
		
      </table>
	    
    </div>

	
	  
<!-- Load the application script, which will save data to our Firebase app when we click the button. -->
<script>
var config = {
    apiKey: "AIzaSyDaHs9ntxRH2E1eV97UHCp2xhSSev_7_vY",
    authDomain: "dsnsdk-cea95.firebaseapp.com",
    databaseURL: "https://dsnsdk-cea95.firebaseio.com",
    projectId: "dsnsdk-cea95",
    storageBucket: "dsnsdk-cea95.appspot.com",
    messagingSenderId: "257952534169"
};

// Initialize your Firebase app
firebase.initializeApp(config);

// Reference to the comment's object in your Firebase database
var comments = firebase.database().ref("comments");


// Save a new comment to the database, using the input in the form
var submitComment = function () {

  var title = $("#yourName").val();
  var remark = $("#yourComment").val();
  var link = $("#yourLink").val();

  comments.push({
    "title": title,
    "remark": remark,
    "link": link
  });
};


comments.limitToLast(10).on('child_added', function(childSnapshot) {

  comment = childSnapshot.val();

  $("#title").append(comment.title + '<br> <br>')
  $("#remark").append(comment.remark + '<br> <br>')
  $("#link").append(comment.link + '<br> <br>')

  // Make the link actually work and direct to the URL provided
  $("#link").attr("href", comment.link)
});


// When the window is fully loaded, call this function.
$(window).load(function () {
  $("#commentForm").submit(submitComment);
}); 
</script>

	  
  </body>
</html>
